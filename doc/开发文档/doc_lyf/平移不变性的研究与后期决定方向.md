## 平移不变性（针对截图场景）

> 参考：
>
> 1. [实验 | CNN与平移不变性](https://zhuanlan.zhihu.com/p/42747793)
>
> 2. [既然cnn对图像具有平移不变性，那么利用 图像平移（shift）进行数据增强来训练cnn会有效果吗？ - 铁心核桃的回答 - 知乎](https://www.zhihu.com/question/301522740/answer/1819876848) 
> 3. [深度学习在信息隐藏中的应用](https://blog.csdn.net/MajorDong100/article/details/78470176/)

关于平移不变性结论：

1. 卷积有平移不变性，但是卷积神经网络并不具有严格的平移不变性。
2. CNN 丢失平移不变性是下采样（Pooling 和 Stride = 2 的 Conv）引起的。
3. Max_Pooling 其实对于平移不变性有一定的保持作用。
4. 虽然在分类任务中会将 Feature Map 展平接 FC，但是全卷积网络也出现了平移不变性很差的情况，这说明 FC 层不是主导因素。

关于项目局部识别：

1. 我们要求 CNN 应用于分类任务具有平移不变，因此在大多数工程应用中会加入**平移增广**，训练模型来拟合“**移不变期许**”的结果，然而实际上算法本身已经决定了其不具备“**移不变特性**”。
2. 隐写内容在特征角度来说，是比较弱的信息。若将隐写图像裁剪部分，再通过**平移增广**，将会加重 Decoder 负担，从而在生成对抗中 Decoder 强迫 Encoder 改变编码方式，使得 Encoder 生成图像不佳。（该部分已通过实验）
3. SwinTransformer 最开始的 patch_embeding 层，决定了隐写的内容一定要平移其 patch_size 的整数倍，才能做到平移不变，这样的概率并不大，并不能很好的解决平移问题。

现状：

1. 以 SwinTransformer 为主干的 Decoder 在生成对抗训练中效果不佳，暂时原因不明。
2. 像之前说的一样，本质上只要局部的隐写图像不发生平移，即只遮挡掉外围一圈，则不会严重干扰识别。因此我们可以**枚举截图在原图中的坐标位置，进行大规模解码即可**。
3. 真实的应用场景决定了需要解码的次数并不会很多、实时性要求不高，因此支持了第二条的设想成为可能。并且也可以更加安全地保证，一旦截图泄露，我们也绝对可以通过第二条的设想溯源（除非改变泄露图片大小）。
4. 在上一条枚举坐标解码的情况下，可以关闭 STN 模块，直接使用 Conv 网络解码。
5. 更多的分类（编码信息的长度）、更强的失真，其实decoder是可以训练的，但是代价是encoder需要生成主要信息

<img src="平移不变性的研究与后期决定方向/HiddenWatermark.jpg" alt="HiddenWatermark" style="zoom:150%;" />

局部截屏失真场景：![image-20220210220936628](平移不变性的研究与后期决定方向/image-20220210220936628.png)![image-20220210220931518](平移不变性的研究与后期决定方向/image-20220210220931518.png)

整体拍照失真场景：![image-20220210223739014](平移不变性的研究与后期决定方向/image-20220210223739014.png)![image-20220210223745260](平移不变性的研究与后期决定方向/image-20220210223745260.png)

